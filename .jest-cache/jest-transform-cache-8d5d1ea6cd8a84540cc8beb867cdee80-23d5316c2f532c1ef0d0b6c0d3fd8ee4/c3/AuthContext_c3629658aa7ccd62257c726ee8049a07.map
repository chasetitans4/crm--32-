{"version":3,"names":["cov_19mtpf45vv","actualCoverage","s","AuthProvider","f","useAuth","withAuth","AuthContext","_react","createContext","undefined","children","authState","setAuthState","useState","_auth","authService","getState","useEffect","unsubscribe","subscribe","contextValue","signUp","bind","signIn","signOut","resetPassword","updatePassword","updateProfile","uploadAvatar","isAuthenticated","hasRole","getAccessToken","_jsxruntime","jsx","Provider","value","context","useContext","b","Error","Component","AuthenticatedComponent","props","loading","className","jsxs"],"sources":["C:\\Users\\chase\\Downloads\\crm (32)\\src\\context\\AuthContext.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport { createContext, useContext, useEffect, useState } from \"react\"\nimport { authService, type AuthState, type AuthUser } from \"../services/auth\"\n\n// Re-export AuthUser for components that need it\nexport type { AuthUser }\n\ninterface AuthContextType extends AuthState {\n  signUp: (email: string, password: string, userData?: { name?: string }) => Promise<AuthUser>\n  signIn: (email: string, password: string) => Promise<AuthUser>\n  signOut: () => Promise<void>\n  resetPassword: (email: string) => Promise<void>\n  updatePassword: (newPassword: string) => Promise<void>\n  updateProfile: (updates: Partial<AuthUser>) => Promise<AuthUser>\n  uploadAvatar: (file: File) => Promise<string>\n  isAuthenticated: () => boolean\n  hasRole: (role: string) => boolean\n  getAccessToken: () => string | null\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined)\n\nexport const AuthProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n  const [authState, setAuthState] = useState<AuthState>(authService.getState())\n\n  useEffect(() => {\n    // Subscribe to auth state changes\n    const unsubscribe = authService.subscribe(setAuthState)\n    return unsubscribe\n  }, [])\n\n  const contextValue: AuthContextType = {\n    ...authState,\n    signUp: authService.signUp.bind(authService),\n    signIn: authService.signIn.bind(authService),\n    signOut: authService.signOut.bind(authService),\n    resetPassword: authService.resetPassword.bind(authService),\n    updatePassword: authService.updatePassword.bind(authService),\n    updateProfile: authService.updateProfile.bind(authService),\n    uploadAvatar: authService.uploadAvatar.bind(authService),\n    isAuthenticated: authService.isAuthenticated.bind(authService),\n    hasRole: authService.hasRole.bind(authService),\n    getAccessToken: authService.getAccessToken.bind(authService),\n  }\n\n  return <AuthContext.Provider value={contextValue}>{children}</AuthContext.Provider>\n}\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext)\n  if (context === undefined) {\n    throw new Error(\"useAuth must be used within an AuthProvider\")\n  }\n  return context\n}\n\n// Higher-order component for protecting routes\nexport const withAuth = <P extends object>(Component: React.ComponentType<P>) => {\n  return function AuthenticatedComponent(props: P) {\n    const { isAuthenticated, loading } = useAuth()\n\n    if (loading) {\n      return (\n        <div className=\"flex items-center justify-center min-h-screen\">\n          <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600\"></div>\n        </div>\n      )\n    }\n\n    if (!isAuthenticated()) {\n      return (\n        <div className=\"flex items-center justify-center min-h-screen\">\n          <div className=\"text-center\">\n            <h1 className=\"text-2xl font-bold text-gray-900 mb-4\">Access Denied</h1>\n            <p className=\"text-gray-600\">Please sign in to access this page.</p>\n          </div>\n        </div>\n      )\n    }\n\n    return <Component {...props} />\n  }\n}\n"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}