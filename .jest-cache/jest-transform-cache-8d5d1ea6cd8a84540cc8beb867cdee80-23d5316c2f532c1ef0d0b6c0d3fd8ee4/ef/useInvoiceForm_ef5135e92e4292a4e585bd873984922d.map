{"version":3,"names":["useInvoiceForm","defaultItem","cov_2c88gyy6pm","s","description","quantity","price","total","defaultInvoiceValues","id","clientId","clientName","clientEmail","clientAddress","invoiceNumber","Date","now","issueDate","dueDate","setDate","getDate","notes","status","items","subtotal","tax","totalAmount","initialData","onSubmit","f","toast","_usetoast","useToast","form","_reacthookform","useForm","resolver","_zod","zodResolver","_contractInvoiceSchemas","invoiceSchema","defaultValues","_react","useEffect","b","rest","newValues","reset","fields","append","remove","useFieldArray","control","name","handleSubmit","data","title","error","variant","addItem","removeItem","index","watch","reduce","acc","item","taxRate","taxAmount","setValue"],"sources":["C:\\Users\\chase\\Downloads\\crm (32)\\src\\hooks\\useInvoiceForm.ts"],"sourcesContent":["\"use client\"\n\nimport { useEffect } from \"react\"\nimport { zodResolver } from \"@hookform/resolvers/zod\"\nimport { useForm, useFieldArray, UseFormReturn } from \"react-hook-form\"\nimport { invoiceSchema, type Invoice, type Item } from \"../schemas/contractInvoiceSchemas\"\nimport { useToast } from \"../components/ui/use-toast\"\n\nconst defaultItem: Omit<Item, 'id'> = { description: \"\", quantity: 1, price: 0, total: 0 };\n\nconst defaultInvoiceValues: Invoice = {\n    id: ``,\n    clientId: ``,\n    clientName: \"\",\n    clientEmail: \"\",\n    clientAddress: \"\",\n    invoiceNumber: `INV-${Date.now()}`,\n    issueDate: new Date(),\n    dueDate: new Date(new Date().setDate(new Date().getDate() + 30)),\n    notes: \"\",\n    status: \"Draft\",\n    items: [\n        {\n            id: `item-${Date.now()}`,\n            ...defaultItem\n        }\n    ],\n    subtotal: 0,\n    tax: 0,\n    totalAmount: 0,\n}\n\nexport const useInvoiceForm = (\n    initialData?: Partial<Invoice> | null,\n    onSubmit?: (data: Invoice) => void | Promise<void>\n) => {\n    const { toast } = useToast()\n\n    const form: UseFormReturn<Invoice> = useForm<Invoice>({\n        resolver: zodResolver(invoiceSchema),\n        defaultValues: defaultInvoiceValues\n    })\n\n    useEffect(() => {\n        if (initialData) {\n            const { issueDate, dueDate, ...rest } = initialData;\n            const newValues: Partial<Invoice> = { ...rest };\n            if (issueDate) {\n                newValues.issueDate = new Date(issueDate);\n            }\n            if (dueDate) {\n                newValues.dueDate = new Date(dueDate);\n            }\n            form.reset({ ...defaultInvoiceValues, ...newValues });\n        } else {\n            form.reset(defaultInvoiceValues);\n        }\n    }, [initialData, form]);\n\n\n    const { fields, append, remove } = useFieldArray({\n        control: form.control,\n        name: \"items\",\n    })\n\n    const handleSubmit = async (data: Invoice) => {\n        try {\n            if (onSubmit) {\n                await onSubmit(data)\n            }\n            toast({\n                title: \"Invoice Saved\",\n                description: `Invoice ${data.invoiceNumber} has been successfully saved.`,\n            })\n        } catch (error) {\n            toast({\n                title: \"Error\",\n                description: \"Failed to save invoice.\",\n                variant: \"destructive\",\n            })\n        }\n    }\n\n    const addItem = () => {\n        append({ id: `item-${Date.now()}`, ...defaultItem });\n    }\n\n    const removeItem = (index: number) => {\n        remove(index)\n    }\n\n    const items = form.watch(\"items\")\n    const subtotal = (items || []).reduce((acc, item) => acc + (item.quantity || 0) * (item.price || 0), 0)\n    const taxRate = form.watch('tax') || 0;\n    const taxAmount = subtotal * (taxRate / 100);\n    const total = subtotal + taxAmount;\n    \n    useEffect(() => {\n        form.setValue('subtotal', subtotal);\n        form.setValue('totalAmount', total);\n    }, [subtotal, total, form]);\n\n    return {\n        form,\n        fields,\n        addItem,\n        removeItem,\n        onSubmit: form.handleSubmit(handleSubmit),\n        total,\n        subtotal,\n        taxAmount\n    }\n}\n"],"mappings":"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","ignoreList":[]}